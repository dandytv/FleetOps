angular.module("FraudApp",["ngRoute","App.Utils","ngSanitize","ui.select","ngRouteAnimationManager"]).run(function(n,t,i,r){t.tables={};t.obj={};t.urlPrefix=$("#hdUrlPrefix").val();t.$on("updatePath",function(n,t){i.path(t)});t.$on("$routeChangeStart",function(n,i){t.$broadcast("routeChanged",i.pageKey)});t.$on("$routeChangeSuccess",function(){var n=i.path();n=="/new"?(t.obj._type="edit",t.obj.eventId=null):n=="/"?(t.obj._type="index",t.obj.eventId=null):(t.obj.eventId=r.eventId,t.obj.acctNo=r.acctNo,t.obj.cardNo=r.cardNo,t.obj.cmpyName=r.cmpyName,t.obj._type="edit")})}).factory("Api",function(n,t){var i=t.getRootUrl()+"/Fraud",r=function(){return n({method:"GET",url:ApiRef})};return GetFormData=function(t,r){var u=r||i,f=$.param(t);return n({method:"GET",url:u+"/FillData?"+f})},GetCardNoList_ByAcctNo=function(t){var r=$.param(t);return n({url:i+"/GetCardNoList_ByAcctNo?"+r,method:"GET"})},GetFraudCustomerDetailsList=function(t){var r=$.param(t);return n({method:"GET",url:i+"/GetFraudCustomerDetailsList?"+r})},GetCardDetailsList_ByAcctNoCardNo=function(t,r){return r.FraudCards=t,t.length>0&&(r.AcctNo=t[0].AcctNo),n({url:i+"/GetCardDetailsList_ByAcctNoCardNo",method:"POST",data:JSON.stringify({_FraudCardDetailsViewModel:r})})},SaveFraud=function(i,r,u){var f=$.extend(i,r);return f=$.extend(f,u),n({url:t.getRootUrl()+"/Fraud/SaveFraud",method:"POST",data:f})},SaveTxn=function(i){return n({url:t.getRootUrl()+"/Fraud/SaveTxn",method:"POST",data:i})},{selectData:r,GetFormData:GetFormData,GetCardNoList_ByAcctNo:GetCardNoList_ByAcctNo,GetFraudCustomerDetailsList:GetFraudCustomerDetailsList,GetCardDetailsList_ByAcctNoCardNo:GetCardDetailsList_ByAcctNoCardNo,SaveFraud:SaveFraud,SaveTxn:SaveTxn}}).config(function(n,t){var i=$("#hdUrlPrefix").val();n.when("/",{templateUrl:"index.html",controller:"indexController",data:{animationConf:{}}}).when("/new",{templateUrl:i+"/Fraud/Tmpl?Prefix=fci&type=New",controller:"detailsController",pageKey:"fraudInfo",data:{animationConf:{}}}).when("/events/:eventId?",{templateUrl:i+"/Fraud/Tmpl?Prefix=fci&type=Index",controller:"detailsController",pageKey:"fraudInfo",data:{animationConf:{}}}).when("/txndispute/:eventId/:acctNo/:cardNo/:cmpyName",{templateUrl:i+"/Fraud/Tmpl?Prefix=txn&type=Index",controller:"txndisputeController",pageKey:"txnDispute",data:{animationConf:{}}}).when("/print/:eventId",{templateUrl:i+"/Fraud/Tmpl?Prefix=prt&type=Index",controller:"printController",pageKey:"print",data:{animationConf:{}}}).when("/fileManager/:eventId?",{templateUrl:i+"/Fraud/Tmpl?Prefix=fil&type=Index",controller:"fileManagerController",pageKey:"fraudfileManager"});t.setDefaultAnimation("fade")}).controller("indexController",function(n,t,i){t.obj._type="index";n.dtOptions={serverSide:!0,processing:!0,checkBox:!1,scrollX:!0,id:"tblFraudCastList",ajax:t.getRootUrl()+"/Fraud/FTGetFraudCaseList",createdRow:function(n,t){t[4].toString().toLowerCase()=="close"?$(n).find("td").eq(4).addClass("label-success"):t[4].toString().toLowerCase()=="open"?$(n).find("td").eq(4).addClass("label-danger"):t[4].toString().toLowerCase()=="in progress"&&$(n).find("td").eq(4).addClass("label-warning")},edit:{level:"scope",func:"indexSelected"}};n.$on("indexSelected",function(r,u){t.obj.eventId=u[0];i.path("/events/"+u[0]);n.$apply()})}).controller("detailsController",function(n,t,i,r,u,f){var e=t.eventId||i.obj.eventId;n.isNew=e?!1:!0;n._Object={};n._Selects={};n.FraudCards=[];n._Selects.CardNo=[];n._Object.FraudIncidentsViewModel=null;n._Selects.FraudIncidentsViewModel=null;n._Object.FraudCustomerDetailsViewModel=null;n._Object.FraudCardDetailsViewModel=null;u.GetFormData({Prefix:"details",EventId:e}).success(function(t){n._Object.FraudIncidentsViewModel=t._FraudIncidentsViewModel;n._Selects.FraudIncidentsViewModel=t.Selects;n.obj.acctNo=t._FraudCustomerDetailsViewModel.AcctNo;n._Object.FraudCustomerDetailsViewModel=t._FraudCustomerDetailsViewModel;n._Object.FraudCardDetailsViewModel=t._FraudCardDetailsViewModel;n.FraudCards=n._Object.FraudCardDetailsViewModel.FraudCards;n._Selects.CardNo=t.CardNo.CardNo;n.Enum_NatureOfIncident=t.Enum_NatureOfIncident;t.aaData&&t.model?(n.showCustTable=!0,n.CustDetailsSales=t.aaData,n.FraudCards=t.liFraudCards,i.obj.cmpyName=t.model[0],n._Object.FraudCustomerDetailsViewModel.CmpyName1=t.model[0],n._Object.FraudCustomerDetailsViewModel.AccountType=t.model[1],n._Object.FraudCustomerDetailsViewModel.ClientType=t.model[2],n._Object.FraudCustomerDetailsViewModel.AgeingDays=t.model[3],n.Month1Date=t.model[4],n.Month2Date=t.model[5],n.Month3Date=t.model[6],n.Month4Date=t.model[7],n.Month5Date=t.model[8],n.Month6Date=t.model[9],n.AvgSalesDisplay=t.model[10]):n.showCustTable=!1;t.cardaaData&&t.cardaaData.length>0&&t.cardModel?(n.showCardTable=!0,n.CardDetailsSales=t.cardaaData,n.CardMonth1Date=t.cardModel[0],n.CardMonth2Date=t.cardModel[1],n.CardMonth3Date=t.cardModel[2],n.CardMonth4Date=t.cardModel[3],n.CardMonth5Date=t.cardModel[4],n.CardMonth6Date=t.cardModel[5],n.CardAvgSalesDisplay=t.cardModel[6]):(n.showCardTable=!1,n.CardDetailsSales=null,n.CardMonth1Date=null,n.CardMonth2Date=null,n.CardMonth3Date=null,n.CardMonth4Date=null,n.CardMonth5Date=null,n.CardMonth6Date=null,n.CardAvgSalesDisplay=null)});n.entryDisabled=!1;n.$on("SearchItemSelected",function(t,r){r={AcctNo:r?r.item.value:val};n.obj.acctNo=r.AcctNo;u.GetFraudCustomerDetailsList({EventId:n.eventId,AcctNo:r.AcctNo}).success(function(t){n.CustDetailsSales=t.aaData;n._Object.FraudCardDetailsViewModel.AcctNo=r.AcctNo;n._Object.FraudCustomerDetailsViewModel.AcctNo=r.AcctNo;i.obj.cmpyName=t.model[0];n._Object.FraudCustomerDetailsViewModel.CmpyName1=t.model[0];n._Object.FraudCustomerDetailsViewModel.AccountType=t.model[1];n._Object.FraudCustomerDetailsViewModel.ClientType=t.model[2];n._Object.FraudCustomerDetailsViewModel.AgeingDays=t.model[3];n.Month1Date=t.model[4];n.Month2Date=t.model[5];n.Month3Date=t.model[6];n.Month4Date=t.model[7];n.Month5Date=t.model[8];n.Month6Date=t.model[9];n.AvgSalesDisplay=t.model[10];n.showCustTable=t.model[10]?!0:!1;u.GetCardNoList_ByAcctNo({AcctNo:r.AcctNo,EventId:n.eventId}).success(function(t){n.FraudCards=[];n._Selects.CardNo=t.cardList.CardNo;n.CardDetailsSales=null;n.CardMonth1Date=null;n.CardMonth2Date=null;n.CardMonth3Date=null;n.CardMonth4Date=null;n.CardMonth5Date=null;n.CardMonth6Date=null;n.CardAvgSalesDisplay=null;n.showCardTable=!1})})});n.CreateNewItem=function(){var t,i;n.obj.acctNo&&(t=!1,angular.forEach(n.FraudCards,function(n){n.SelectedCardNo||(t=!0)}),t||(n.entryDisabled=!1,i=n.FraudCards.length,n.FraudCards.push({CardNo:null,AcctNo:n.obj.acctNo,SelectedCardNo:null,isEdit:!0})))};n.removeItem=function(t){var i=n.FraudCards.indexOf(t);n.FraudCards.splice(i,1);t.AcctNo&&u.GetCardDetailsList_ByAcctNoCardNo(n.FraudCards,n._Object.FraudCardDetailsViewModel).success(function(t){t.aaData&&t.aaData.length>0&&t.model?(n.showCardTable=!0,n.CardDetailsSales=t.aaData,n.CardMonth1Date=t.model[0],n.CardMonth2Date=t.model[1],n.CardMonth3Date=t.model[2],n.CardMonth4Date=t.model[3],n.CardMonth5Date=t.model[4],n.CardMonth6Date=t.model[5],n.CardAvgSalesDisplay=t.model[6]):(n.showCardTable=!1,n.CardDetailsSales=null,n.CardMonth1Date=null,n.CardMonth2Date=null,n.CardMonth3Date=null,n.CardMonth4Date=null,n.CardMonth5Date=null,n.CardMonth6Date=null,n.CardAvgSalesDisplay=null)})};n.insertRecord=function(t){if(t.SelectedCardNo){if(n.isEdit){t.processing=!0;var i=n.MCardDetails;$.extend(t,{CardNo:t.SelectedCardNo,AcctNo:n.obj.acctNo});t.isEdit=!1;n.entryDisabled=!1}else t.isEdit=!1;n.obj.acctNo&&u.GetCardDetailsList_ByAcctNoCardNo(n.FraudCards,n._Object.FraudCardDetailsViewModel).success(function(t){n.showCardTable=!0;n.CardDetailsSales=t.aaData;n.CardMonth1Date=t.model[0];n.CardMonth2Date=t.model[1];n.CardMonth3Date=t.model[2];n.CardMonth4Date=t.model[3];n.CardMonth5Date=t.model[4];n.CardMonth6Date=t.model[5];n.CardAvgSalesDisplay=t.model[6]})}};n.SaveFraud=function(){f.InfoNotify();n.FilteredFraudCards=n.FraudCards;angular.forEach(n.FraudCards,function(t,i){t.isEdit&&n.FilteredFraudCards.splice(i,1)});n._Object.FraudCardDetailsViewModel.FraudCards=n.FilteredFraudCards;u.SaveFraud(n._Object.FraudCustomerDetailsViewModel,n._Object.FraudCardDetailsViewModel,n._Object.FraudIncidentsViewModel).success(function(t){f.finalResultNotify(t.resultCd);t.resultCd.flag==0&&n.isNew&&(i.obj.eventId=t._eventId,n._Object.FraudCustomerDetailsViewModel.EventId=t._eventId,n.isNew=!1,i.obj._type="edit",r.path("/events/"+t._eventId),n.$apply())})};n.refresh=function(){n.tables[n.dtOptions.id].fnDraw()};n.NatureOfIncidentChanged=function(t,i){i!=n.Enum_NatureOfIncident&&(n._Object.FraudIncidentsViewModel.OtherNatureOfIncident="")}}).controller("txndisputeController",function(n,t,i,r,u,f){function c(){var t,l,u,c;f.makeObjectNull(n._Object.FraudTxnDisputeViewModel,{AcctNo:s,EventId:o,SelectedCardNo:h});t=i.tables[n.dtOptionsPostedTxn.id];l=i.tables[n.dtOptionsDisputeTxn.id];t.fnClearTable(0);t&&(u=t.closest(".dataTables_scroll").find(".dataTables_scrollHead").find("input"),u[0].checked=!1);c=angular.extend(n.dtOptionsPostedTxn,{serverSide:!1,ajax:"",drawCallback:"",destroy:!0,checkBox:!1});n.$broadcast("updateDataTable",{options:c});var a=i.getRootUrl()+"/Fraud/GetFraudTxnSearch?",r=n._Object.FraudTxnDisputeViewModel,v=$.param({SelectedCardNo:i.obj.cardNo,SelectedTxnCategory:r.SelectedTxnCategory,EventId:i.obj.eventId,SelectedTxnCd:r.SelectedTxnCd,FromDate:r.FromDate,ToDate:r.ToDate,AcctNo:i.obj.acctNo,IsPostedDispute:e==!0?"1":"2"}),y=angular.extend(n.dtOptionsDisputeTxn,{serverSide:!0,ajax:a+v,destroy:!0,checkBox:!0,drawCallback:function(){var t=i.tables[n.dtOptionsDisputeTxn.id],r;t&&(r=t.closest(".dataTables_scroll").find(".dataTables_scrollHead").find("input"),r[0].checked=!1);n.modalOpen.PostTxn=!1;n.$apply()}});n.$broadcast("updateDataTable",{options:y})}var e=!0;i.obj._type="txn";n.modalOpen={};n.modalOpen.PostTxn=!1;n.aaData=[];var o=t.eventId||i.obj.eventId,s=i.obj.acctNo||t.acctNo,h=i.obj.cardNo||t.cardNo;n._Object={};n._Object.FraudTxnDisputeViewModel={};n._Selects=[];u.GetFormData({Prefix:"txn"}).success(function(t){n._Selects.FraudTxnDisputeViewModel=t.Selects});n.dtOptionsPostedTxn={serverSide:!1,processing:!0,scrollX:!0,id:"tblPostedTxn",retrieve:!0,ordering:!1,searching:!1,ajax:""};n.dtOptionsDisputeTxn={serverSide:!1,processing:!0,scrollX:!0,id:"tblDisputeTxn",retrieve:!0,ordering:!1,searching:!1,ajax:""};n.SearchTxn=function(){var r=i.getRootUrl()+"/Fraud/GetFraudTxnSearch?",t=n._Object.FraudTxnDisputeViewModel,u=$.param({SelectedCardNo:i.obj.cardNo,SelectedTxnCategory:t.SelectedTxnCategory,EventId:i.obj.eventId,SelectedTxnCd:t.SelectedTxnCd,FromDate:t.FromDate,ToDate:t.ToDate,AcctNo:i.obj.acctNo,IsPostedDispute:e==!0?"1":"2"}),f;f=e?angular.extend(n.dtOptionsPostedTxn,{serverSide:!0,ajax:r+u,destroy:!0,checkBox:!0,drawCallback:function(){var t=i.tables[n.dtOptionsPostedTxn.id],r;t&&(r=t.closest(".dataTables_scroll").find(".dataTables_scrollHead").find("input"),r[0].checked=!1);n.modalOpen.PostTxn=!1;n.$apply()}}):angular.extend(n.dtOptionsDisputeTxn,{serverSide:!0,ajax:r+u,destroy:!0,checkBox:!0,drawCallback:function(){var t=i.tables[n.dtOptionsDisputeTxn.id],r;t&&(r=t.closest(".dataTables_scroll").find(".dataTables_scrollHead").find("input"),r[0].checked=!1);n.modalOpen.PostTxn=!1;n.$apply()}});n.$broadcast("updateDataTable",{options:f})};n.loadPostedTxn=function(){e=!0;c()};n.loadDisputedTxn=function(){e=!1;c()};n.modalClick=function(){n.modalOpen.PostTxn=!0};n.SaveDisputeTxn=function(){var r=f.getSelectedRows(i.tables[n.dtOptionsDisputeTxn.id]),t=_.map(r,function(n){return n[1]});t&&t.length>0&&(f.InfoNotify(),u.SaveTxn({liTxnId:t,AcctNo:s,CardNo:h,EventId:o,IsPostedDispute:e==!0?"1":"2"}).success(function(t){f.finalResultNotify(t.resultCd);i.tables[n.dtOptionsDisputeTxn.id].fnDraw()}))};n.SavePostedTxn=function(){var r=f.getSelectedRows(i.tables[n.dtOptionsPostedTxn.id]),t=_.map(r,function(n){return n[1]});t&&t.length>0&&(f.InfoNotify(),u.SaveTxn({liTxnId:t,AcctNo:s,CardNo:h,EventId:o,IsPostedDispute:e==!0?"1":"2"}).success(function(t){f.finalResultNotify(t.resultCd);i.tables[n.dtOptionsPostedTxn.id].fnDraw()}))}}).controller("printController",function(n,t,i,r,u){i.obj._type="txn";var f=t.eventId||i.obj.eventId;n.applId=f;u.GetFormData({Prefix:"details",EventId:f}).success(function(t){var r=$.extend(t._FraudCustomerDetailsViewModel,t._FraudCardDetailsViewModel),i;r=$.extend(r,t._FraudIncidentsViewModel);n._Object=r;n._Object.todayDate=new Date;n._Object.FraudCards=t.liFraudCards;n._Object.SubsidyNo=t.model[11];n._Object.FraudCards&&(i="",angular.forEach(n._Object.FraudCards,function(n){i=i+n.SelectedCardNo+" , "}),n._Object.FraudCardsInLine=i.slice(0,-2),t.cardaaData&&t.cardaaData.length>0&&(n.CardDetailsSales=t.cardaaData,angular.forEach(n._Object.FraudCards,function(n,i){$.extend(n,{CardAvgSales:t.cardaaData[i][6],SingleTxn:t.cardaaData[i][7],DailyTxn:t.cardaaData[i][8],MonthlyTxn:t.cardaaData[i][9]})})));t.model&&(n._Object.CmpyName1=t.model[0],n._Object.AccountType=t.model[1],n._Object.ClientType=t.model[2],n._Object.AgeingDays=t.model[3]);t.aaData&&t.aaData[0]&&(n._Object.AvgSales=t.aaData[0][6])})}).controller("fileManagerController",function(n,t,i,r,u,f,e){n.FolderPath="2";n.eventId=i.eventId||t.eventId;n.uploadFiles=function(){if(n.dropZone.getQueuedFiles().length==0)return toastr.error("please select atleast one image for upload");f.InfoNotify();n.dropZone.processQueue()};e.get(t.getRootUrl()+"/Applications/GetFiles?ApplId="+n.eventId+"&FolderPath="+n.FolderPath).success(function(t){n.files=t.files});n.deleteFileConfirmation=function(t){n.markedFile=t};n.deleteFile=function(i){n.markedFile=i;var r=n.markedFile;e.get(t.getRootUrl()+"/Applications/RemoveFile?FileName="+r.FileName+"&ApplId="+n.eventId+"&FolderPath="+n.FolderPath).success(function(){var t=n.files.indexOf(r);n.files.splice(t,1)})}}).directive("fileDropzone",function(n,t){return{restrict:"A",link:function(n){n.eventId&&(typeof Dropzone!="undefined"&&(Dropzone.options.fileDropzone={autoProcessQueue:!0,parallelUploads:10,uploadMultiple:!0,maxFilesize:4,acceptedFiles:".jpeg,.jpg,.png,.pdf,.doc,.docx,.xls,.xlsx,.txt",init:function(){this.on("addedfile",function(){});this.on("sending",function(t,i,r){i.setRequestHeader("ApplId",n.eventId);r.append("FolderPath",n.FolderPath)});this.on("success",function(t){n.files.push({FileName:t.name,Size:parseInt(t.size/1024,10),Extension:t.type,CreatedDate:"Just now",Class:"success"});n.dropZone.removeAllFiles();n.$apply()});this.on("queuecomplete",function(){alert("queue complete")});this.on("processing",function(){})}},Dropzone.autoDiscover=!1,Dropzone.autoProcessQueue=!0),n.dropZone=new Dropzone("#file-dropzone"),dze_info=$("#dze_info"),status={uploaded:0,errors:0},t(function(){}))}}});
//# sourceMappingURL=Fraud.min.js.map