angular.module("AccountsApp",["ngRoute","App.Utils","ngSanitize","ui.select","datetime"]).run(function(n,t,i,r,u){t.tables={};t.obj={};t.obj.acctNo=$("#hdAcctNo").val();var f=t.obj.acctNo;t.loadAdj=function(){u(function(){t.dtOptionsTxnAdj={serverSide:!0,processing:!0,checkBox:!1,autoWidth:!1,scrollX:!0,id:"tblTxnAdj",ajax:t.getRootUrl()+"/Account/WebAcctMilestoneListSelect?"+$.param({Ind:1,workflowcd:"Adj",AcctNo:f}),edit:{level:"scope",func:"AdjindexSelected"}}},200)};t.modalClick=function(){t.modalOpen=!0;t.loadAdj()};t.loadPymt=function(){u(function(){t.dtOptionsPymtTxn={serverSide:!0,processing:!0,checkBox:!1,autoWidth:!1,scrollX:!0,id:"tblPymtTxn",ajax:t.getRootUrl()+"/Account/WebAcctMilestoneListSelect?"+$.param({Ind:1,workflowcd:"Pymt",AcctNo:f}),edit:{level:"scope",func:"PymtindexSelected"}}},500)};t.$on("AdjindexSelected",function(n,i){console.log(i);t.obj.AcctNo=i[1];location.href=t.getRootUrl()+"/Approval#/Approval/Adj/"+i[0]+"/"+i[1];t.$apply()});t.$on("PymtindexSelected",function(n,i){t.obj.AcctNo=i[1];location.href=t.getRootUrl()+"/Approval#/Approval/Pymt/"+i[0]+"/"+i[1];t.$apply()});t.$on("$routeChangeStart",function(n,i){t.$broadcast("routeChanged",i.pageKey)});t.$on("$routeChangeSuccess",function(){var n=i.path();n=="/new"?(t.obj._type="new",t.obj.applId=null):n=="/"?t.obj._type="index":(t.obj.applId=r.applId,t.obj._type="edit")})}).factory("Api",function(n,t){var i=t.getRootUrl()+"/Account",r=function(){return n({method:"GET",url:ApiRef})};return getFormData=function(t,r){var u=r||i,f=$.param(t);return n({method:"GET",url:u+"/FillData?"+f})},getPointBalance=function(i){return n({method:"GET",url:t.getRootUrl()+"/Account/LoadPointBalance?"+$.param(i)})},postGeneralInfo=function(i){return n({url:t.getRootUrl()+"/Account/GeneralInfoMaint",method:"POST",data:i})},FinancialInfoMaint=function(i){return n({url:t.getRootUrl()+"/Account/FinancialInfoMaint",method:"POST",data:i})},SaveCollectionCaseInfo=function(i){return n({url:t.getRootUrl()+"/Account/SaveCollectionCaseInfo",method:"POST",data:i})},SaveVelocityLimit=function(i){return n({url:t.getRootUrl()+"/Applications/SaveVelocityLimit",method:"POST",data:i})},ftVelocityDetail=function(i){return n({url:t.getRootUrl()+"/Applications/ftVelocityDetail?"+$.param(i),method:"GET"})},RemoveVelocity=function(i){return n({url:t.getRootUrl()+"/Applications/DelVelocityLimit?"+$.param(i),method:"GET"})},SaveCreditAssessmentOperation=function(i){return n({url:t.getRootUrl()+"/Account/FtCreditApplAssessmentMaint",method:"POST",data:i})},AcctDepositInfoMaint=function(i){return n({url:t.getRootUrl()+"/Account/AcctDepositInfoMaint",method:"POST",data:i})},ftGetGetAcctDepositInfoDetail=function(i){return n({url:t.getRootUrl()+"/Account/ftGetGetAcctDepositInfoDetail",method:"POST",data:i})},SaveSKDS=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Applications/SaveSKDS",method:"POST",data:i})},ftSKDSDetail=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Applications/ftSKDSDetail?"+r,method:"GET"})},ftAddressDetail=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Applications/ftAddressDetail?"+r,method:"GET"})},SaveAddress=function(i){return n({url:t.getRootUrl()+"/Applications/SaveAddress",method:"POST",data:i})},DelAddress=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Applications/DelAddress?"+r,method:"GET"})},WebGetState=function(r,u){var f=u||i;return n({method:"GET",url:t.getRootUrl()+"/Applications/WebGetState?"+$.param(r)})},ftContactDetail=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Applications/ftContactDetail?"+r,method:"GET"})},SaveContact=function(i){return n({url:t.getRootUrl()+"/Applications/SaveContact",method:"POST",data:i})},RemoveContact=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Applications/DelContact?"+r,method:"GET"})},SaveMiscellanious=function(i){return n({url:t.getRootUrl()+"/Applications/SaveMisecInfo",method:"POST",data:i})},ftVehicleDetail=function(i){return n({url:t.getRootUrl()+"/Applications/ftVehicleDetail?"+$.param(i),method:"GET"})},SaveVehicleLimit=function(i){return n({url:t.getRootUrl()+"/Applications/SaveVehicleLimit",method:"POST",data:i})},CostCentreMaint=function(i){return n({url:t.getRootUrl()+"/Account/CostCentreMaint",method:"POST",data:i})},FtCostCentreDetail=function(i){return n({url:t.getRootUrl()+"/Account/FtCostCentreDetail?"+$.param(i),method:"GET"})},ftTxnAdjDetail=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Account/ftTxnAdjDetail?"+r,method:"GET"})},SaveTxnAdj=function(i){return n({url:t.getRootUrl()+"/Account/SaveTxnAdj",method:"POST",data:i})},DelTxnAdj=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Account/DelTxnAdj?"+r,method:"GET"})},ftPaymentTxnDetail=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Account/ftPaymentTxnDetail?"+r,method:"GET"})},ftPaymentTxnMaint=function(i){return n({url:t.getRootUrl()+"/Account/ftPaymentTxnMaint",method:"POST",data:i})},ftLocationDetail=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Account/ftLocationDetail?"+r,method:"GET"})},SaveLocationAccept=function(i){return n({url:t.getRootUrl()+"/Account/SaveLocationAccept",method:"POST",data:i})},DelLocation=function(i){return n({url:t.getRootUrl()+"/Account/DelLocation?",method:"POST",data:i})},getBusnLocations=function(i){return n({url:t.getRootUrl()+"/Account/getBusnLocations?"+$.param(i),method:"GET"})},TempCreditCtrlMaint=function(i){return n({url:t.getRootUrl()+"/Account/TempCreditCtrlMaint",method:"POST",data:i})},FtChangedStatusMaint=function(i){return n({url:t.getRootUrl()+"/Account/FtChangedStatusMaint",method:"POST",data:i})},ResendActivationEmail=function(i){return n({url:t.getRootUrl()+"/Account/ResendActivationEmail",method:"POST",data:i})},ResetPasswordCounter=function(i){return n({url:t.getRootUrl()+"/Account/ResetPasswordCounter",method:"GET",params:i})},ProductDiscountSelect=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Account/ProductDiscountSelect?"+r,method:"GET"})},ProductDiscountMaint=function(i){return n({url:t.getRootUrl()+"/Account/ProductDiscountMaint",method:"POST",data:i})},DeleteProductDiscount=function(i){return n({url:t.getRootUrl()+"/Account/DeleteProductDiscount",method:"POST",data:i})},WebPointAdjustmentSelect=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Account/WebPointAdjustmentSelect?"+r,method:"GET"})},WebPointAdjustmentMaint=function(i){return n({url:t.getRootUrl()+"/Account/WebPointAdjustmentMaint",method:"POST",data:i})},PukalMaint=function(i){return n({url:t.getRootUrl()+"/Account/SavePukalInfo",method:"POST",data:i})},SaveSKDS=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Applications/SaveSKDS",method:"POST",data:i})},ftSKDSDetail=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Applications/ftSKDSDetail?"+r,method:"GET"})},SaveAcctSubsidyInfoList=function(i){return n({url:t.getRootUrl()+"/Account/SaveAcctSubsidyInfoList",method:"POST",data:i})},GetPlanIdFromSubsidy=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Account/PlanIDProdDisc?"+r,method:"GET"})},WebAcctMilestoneListSelect=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Account/WebAcctMilestoneListSelect?"+r,method:"GET"})},WebEventAcctConfSelect=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Account/WebEventAcctConfSelect?"+r,method:"GET"})},WebEventAcctRcptListSelect=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/Account/WebEventAcctRcptListSelect?"+r,method:"GET"})},WebEventAcctConfMaint=function(i){return n({url:t.getRootUrl()+"/Account/WebEventAcctConfMaint",method:"POST",data:i})},WebNtfEvtConfRcptDelete=function(i){var r=$.param(i);return n({url:t.getRootUrl()+"/EventConfiguration/WebNtfEvtConfRcptDelete",data:i,method:"POST"})},{selectData:r,getFormData:getFormData,getPointBalance:getPointBalance,postGeneralInfo:postGeneralInfo,FinancialInfoMaint:FinancialInfoMaint,SaveCreditAssessmentOperation:SaveCreditAssessmentOperation,SaveCollectionCaseInfo:SaveCollectionCaseInfo,SaveVelocityLimit:SaveVelocityLimit,ftVelocityDetail:ftVelocityDetail,RemoveVelocity:RemoveVelocity,AcctDepositInfoMaint:AcctDepositInfoMaint,ftGetGetAcctDepositInfoDetail:ftGetGetAcctDepositInfoDetail,ftSKDSDetail:ftSKDSDetail,SaveSKDS:SaveSKDS,ftAddressDetail:ftAddressDetail,SaveAddress:SaveAddress,ftContactDetail:ftContactDetail,RemoveContact:RemoveContact,SaveContact:SaveContact,DelAddress:DelAddress,WebGetState:WebGetState,SaveMiscellanious:SaveMiscellanious,SaveVehicleLimit:SaveVehicleLimit,ftVehicleDetail:ftVehicleDetail,CostCentreMaint:CostCentreMaint,FtCostCentreDetail:FtCostCentreDetail,ftTxnAdjDetail:ftTxnAdjDetail,SaveTxnAdj:SaveTxnAdj,DelTxnAdj:DelTxnAdj,ftPaymentTxnDetail:ftPaymentTxnDetail,ftPaymentTxnMaint:ftPaymentTxnMaint,ftLocationDetail:ftLocationDetail,SaveLocationAccept:SaveLocationAccept,DelLocation:DelLocation,getBusnLocations:getBusnLocations,TempCreditCtrlMaint:TempCreditCtrlMaint,FtChangedStatusMaint:FtChangedStatusMaint,ResendActivationEmail:ResendActivationEmail,ResetPasswordCounter:ResetPasswordCounter,ProductDiscountSelect:ProductDiscountSelect,ProductDiscountMaint:ProductDiscountMaint,DeleteProductDiscount:DeleteProductDiscount,WebPointAdjustmentSelect:WebPointAdjustmentSelect,WebPointAdjustmentMaint:WebPointAdjustmentMaint,PukalMaint:PukalMaint,SaveSKDS:SaveSKDS,ftSKDSDetail:ftSKDSDetail,SaveAcctSubsidyInfoList:SaveAcctSubsidyInfoList,WebAcctMilestoneListSelect:WebAcctMilestoneListSelect,GetPlanIdFromSubsidy:GetPlanIdFromSubsidy,WebEventAcctConfSelect:WebEventAcctConfSelect,WebEventAcctRcptListSelect:WebEventAcctRcptListSelect,WebEventAcctConfMaint:WebEventAcctConfMaint,WebNtfEvtConfRcptDelete:WebNtfEvtConfRcptDelete}}).config(function(n){var t=$("#hdUrlPrefix").val();n.when("/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=gen&type=Index",controller:"generalInfoController",pageKey:"generalInfo"}).when("/",{templateUrl:"index.html",controller:"indexController",pageKey:"index"}).when("/generalInfo/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=gen&type=Index",controller:"generalInfoController",pageKey:"generalInfo"}).when("/finanacialInfo/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=fin&type=Index",controller:"finanacialInfoController",pageKey:"finanacialInfo"}).when("/cao/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=cao&type=Index",controller:"caoController",pageKey:"cao"}).when("/velocity/:acctNo?",{templateUrl:t+"/Applications/Tmpl?Prefix=vel&type=Index&overrideController=Account",controller:"velocityController",pageKey:"velocity"}).when("/vehicles/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=veh&type=Index",controller:"vehiclesController",pageKey:"vehicles"}).when("/depositInfo/:acctNo?",{templateUrl:t+"/Applications/Tmpl?Prefix=dep&type=Index&overrideController=Account",controller:"depositInfoController",pageKey:"depositInfo"}).when("/skds/:acctNo?",{templateUrl:t+"/Applications/Tmpl?Prefix=skd&type=Index&overrideController=Account",controller:"skdsController",pageKey:"skds"}).when("/accountSubsidy/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=ast&type=Index",controller:"accountSubsidyController",pageKey:"accountSubsidy"}).when("/cardsList/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=car&type=Index",controller:"cardsListController",pageKey:"cardsList"}).when("/contacts/:applId?",{templateUrl:t+"/Applications/Tmpl?Prefix=con&type=Index&overrideController=Account",controller:"contactsController",pageKey:"contacts"}).when("/address/:applId?",{templateUrl:t+"/Applications/Tmpl?Prefix=add&type=Index&overrideController=Account",controller:"addressController",pageKey:"address"}).when("/costcentre/:acctNo?",{templateUrl:t+"/Applications/Tmpl?Prefix=csc&type=Index&overrideController=Account",controller:"costcentreController",pageKey:"costcentre"}).when("/costcentre/:acctNo?/:cst/velocity",{templateUrl:t+"/Applications/Tmpl?Prefix=ccv&type=Index&overrideController=Account",controller:"velocityController",pageKey:"costCentre"}).when("/Miscellanious/:applId?",{templateUrl:t+"/Applications/Tmpl?Prefix=mis&type=Index&overrideController=Account",controller:"MiscellaniousController",pageKey:"Miscellanious"}).when("/TxnAdjustment/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=txn&type=Index",controller:"TxnAdjustmentController",pageKey:"TxnAdjustment"}).when("/paymentTxn/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=pay&type=Index",controller:"paymentTxnController",pageKey:"paymentTxn"}).when("/locationAcceptance/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=loc&type=Index",controller:"locationAcceptanceController",pageKey:"locationAcceptance"}).when("/tempCreditControl/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=tem&type=Index",controller:"tempCreditController",pageKey:"tempCreditControl"}).when("/statusMaint/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=sta&type=Index",controller:"statusMaintController",pageKey:"statusMaint"}).when("/txnSearch/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=aps&type=Index",controller:"txnSearchController",pageKey:"txnSearch"}).when("/billingItem/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=bil_Main&type=Index&OverridePrefix=bil",controller:"billingItemController",pageKey:"billingItem"}).when("/billingItemDetail/:acctNo?/:type/:txnId",{templateUrl:t+"/Account/Tmpl?Prefix=bil_detail&type=Index&OverridePrefix=bil",controller:"billingDetailController",pageKey:"billingItem"}).when("/userManagement/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=usm&type=Index",controller:"userManagementController",pageKey:"userManagement"}).when("/productDiscount/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=pdc&type=Index",controller:"productDiscountController",pageKey:"productDiscount"}).when("/pointsAdjustment/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=pad&type=Index",controller:"pointsAdjustmentController",pageKey:"pointsAdjustment"}).when("/uptoDateBalance/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=upd&type=Index",controller:"uptoDateBalaceController",pageKey:"uptoDateBalance"}).when("/pukal/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=puk&type=Index",controller:"pukalController",pageKey:"pukal"}).when("/eventConf/:acctNo?",{templateUrl:t+"/Account/Tmpl?Prefix=evc&type=Index",controller:"eventConfigurationController",pageKey:"eventConf"}).when("/eventConfDetail/:acctNo?/:id?/:scheduleId?",{templateUrl:t+"/Account/Tmpl?Prefix=evc&type=Index",controller:"eventConfigurationController",pageKey:"eventConf"})}).controller("generalInfoController",function(n,t,i,r,u){n._Object=null;var f=t.acctNo||i.obj.acctNo;r.getFormData({Prefix:"gen",AcctNo:f}).success(function(t){n._Object=t.Model;n._Selects=t.Selects;n._Object.LoyaltyCardNo&&r.getPointBalance({AcctNo:n._Object.LoyaltyCardNo,RequestorId:"FLT",Token:""}).success(function(t){n._Object.PointBalance=t.PointBal})});n.postGeneralInfo=function(){u.InfoNotify();r.postGeneralInfo(n._Object).success(function(n){u.finalResultNotify(n.result)})}}).controller("tempCreditController",function(n,t,i,r,u){n._Object=null;var f=t.acctNo?t.acctNo:i.obj.acctNo;r.getFormData({Prefix:"tem",AcctNo:f}).success(function(t){n._Object=t.Model;n._Object.acctNo=f;n._Selects=t.Selects});n.Save=function(){u.InfoNotify();r.TempCreditCtrlMaint(n._Object).success(function(n){u.finalResultNotify(n.resultCd)})};n.dtOptions={serverSide:!0,processing:!0,scrollX:!0,id:"tblCredCtrl",ajax:i.getRootUrl()+"/Account/WebEventSearchWithoutDate?AcctNo="+f}}).controller("uptoDateBalaceController",function(n,t,i,r,u){var f=i.acctNo?i.acctNo:t.acctNo;n.instantTxn=0;u.getFormData({Prefix:"upd",AcctNo:f}).success(function(t){n._Object=t.Model});n.ShowInstantTxn=function(){n.instantTxn=1;n.dtOptions={serverSide:!0,processing:!0,scrollX:!0,id:"tblInstantTxn",ajax:t.getRootUrl()+"/Account/TxnInstantListSelect?AcctNo="+f}};n.ShowUnpostedTxn=function(){n.instantTxn=2;n.dtOptions2={serverSide:!0,processing:!0,scrollX:!0,id:"tblUnpostedTxn",ajax:t.getRootUrl()+"/Account/TxnUnpostedListSelect?AcctNo="+f}}}).controller("statusMaintController",function(n,t,i,r,u){n._Object=null;var f=t.acctNo?t.acctNo:i.obj.acctNo;r.getFormData({Prefix:"sta",AcctNo:f}).success(function(t){n._Object=t.Model;n._Object.AccNo=f;n._Selects=t.Selects});n.saveConfirmed=function(){n.confirmModalOpen=!1;u.InfoNotify();r.FtChangedStatusMaint(n._Object).success(function(t){u.finalResultNotify(t.resultCd);t.resultCd.flag==0&&(n._Object.SelectedCurrentStatus=n._Object.SelectedChangeStatusTo)})};n.Save=function(){n._Object.SelectedChangeStatusTo=="T"?n.confirmModalOpen=!0:n.saveConfirmed()}}).controller("finanacialInfoController",function(n,t,i,r,u){n._Object=null;var f=t.acctNo?t.acctNo:i.obj.acctNo;n.dtOptionsCollectionHist={serverSide:!0,processing:!0,checkBox:!1,autoWidth:!1,ordering:!1,scrollX:!0,ajax:i.getRootUrl()+"/Collection/GetCollHistory?AcctNo="+f+"&CollectionCaseSts=O"};r.getFormData({Prefix:"fin",AcctNo:f}).success(function(t){n._Object=t.Model;n._Selects=t.Selects});n.FinancialInfoMaint=function(){u.InfoNotify();r.FinancialInfoMaint(n._Object).success(function(n){u.finalResultNotify(n.result)})};n.SaveCollectionCaseInfo=function(){u.InfoNotify();r.SaveCollectionCaseInfo(n._Object).success(function(t){n.$broadcast("updateDataTable",{options:n.dtOptionsCollectionHist});u.finalResultNotify(t.result)})}}).controller("velocityController",function(n,t,i,r,u){var f=i.acctNo?i.acctNo:t.obj.acctNo,e=i.cst;n.modalOpen=!1;n.deleteModalOpen=!1;n.dtOptions={serverSide:!0,processing:!0,scrollX:!0,id:"tblVelocity",ajax:t.getRootUrl()+"/Applications/ftVelocityList?"+$.param({AccNo:f,CostCentre:e}),edit:{level:"scope",func:"indexSelected"}};n.$on("indexSelected",function(t,i){n.modalOpen=!0;r.ftVelocityDetail({AccNo:f,SelectedVelocityInd:i[9],SelectedProdCd:i[10],CostCentre:e}).success(function(t){n._Object=t.velocity;n._Object.Func="Upd";n._Object.AccNo=f;n._Object.CostCentre=e})});r.getFormData({Prefix:"vel",AcctNo:f}).success(function(t){n._Object=t.Model;n._Object.AccNo=f;n._Selects=t.Selects});n.newVelocity=function(){n.modalOpen=!0;n._Object.Func="Add";u.makeObjectNull(n._Object,{AccNo:f,CostCentre:e})};n.refresh=function(){t.tables[n.dtOptions.id].fnDraw()};n.SaveVelocityLimit=function(){u.InfoNotify();n._Object.AccNo=f;r.SaveVelocityLimit(n._Object).success(function(i){u.finalResultNotify(i.resultCd);i.resultCd.flag!=1&&(t.tables[n.dtOptions.id].fnDraw(),n.modalOpen=!1)})};n.delete=function(){n.deleteModalOpen=!1;var i=u.getSelectedRow(t.tables[n.dtOptions.id]);i&&(u.InfoNotify(),r.RemoveVelocity({AccNo:f,VelInd:i[9],CostCentre:e}).success(function(i){u.finalResultNotify(i.resultCd);t.tables[n.dtOptions.id].fnDraw()}))}}).controller("TxnAdjustmentController",function(n,t,i,r,u){n.acctNo=i.acctNo||t.obj.acctNo;n.modalOpen=!1;n.dtOptions={serverSide:!0,processing:!0,scrollX:!1,id:"tblftTxnAdjList",ajax:t.getRootUrl()+"/Account/ftTxnAdjList?AcctNo="+n.acctNo,edit:{level:"scope",func:"indexSelected"}};n.modalClick=function(){n.modalOpen=!0;u.makeObjectNull(n._Object,{AcctNo:n.acctNo,SelectedSts:"H"})};n.$on("indexSelected",function(t,i){n.modalOpen=!0;r.ftTxnAdjDetail({TxnId:i[7]}).success(function(t){n._Object=t.txn})});r.getFormData({Prefix:"txn",AcctNo:n.acctNo}).success(function(t){n._Object=t.Model;n._Object.Func=!0;n._Selects=t.Selects});n.refresh=function(){t.tables[n.dtOptions.id].fnDraw()};n.SaveTxnAdjustment=function(){u.InfoNotify();n._Object.AccNo=n.acctNo;r.SaveTxnAdj(n._Object).success(function(i){u.finalResultNotify(i.txn);i.txn.flag!=1&&(t.tables[n.dtOptions.id].fnDraw(),n.modalOpen=!1)})};n.deleteRecord=function(){n.deleteModalOpen=!1;var i=u.getSelectedRow(t.tables[n.dtOptions.id]);i&&(u.InfoNotify(),r.DelTxnAdj({AcctNo:n.acctNo,CardNo:i[1],TxnId:i[7]}).success(function(i){u.finalResultNotify(i.resultCd);t.tables[n.dtOptions.id].fnDraw()}))}}).controller("paymentTxnController",function(n,t,i,r,u){n.acctNo=i.acctNo?i.acctNo:t.obj.acctNo;n.modalOpen=!1;n.dtOptions={serverSide:!0,processing:!0,scrollX:!1,id:"tblPaymentTxn",ajax:t.getRootUrl()+"/Account/ftPaymentTxnList?AcctNo="+n.acctNo,edit:{level:"scope",func:"indexSelected"}};n.modalClick=function(){n.modalOpen=!0;u.makeObjectNull(n._Object,{AcctNo:n.acctNo,SelectedSts:"H"})};n.$on("indexSelected",function(t,i){n.modalOpen=!0;r.ftPaymentTxnDetail({PyTxnId:i[5]}).success(function(t){n._Object=t.txn;n._Object.AcctNo=n.acctNo})});r.getFormData({Prefix:"pay",AcctNo:n.acctNo}).success(function(t){n._Object=t.Model;n._Object.Func=!0;n._Selects=t.Selects});n.refresh=function(){t.tables[n.dtOptions.id].fnDraw()};n.Save=function(){u.InfoNotify();n._Object.AccNo=n.acctNo;r.ftPaymentTxnMaint(n._Object).success(function(i){u.finalResultNotify(i.resultCd);i.resultCd.flag!=1&&(t.tables[n.dtOptions.id].fnDraw(),n.modalOpen=!1)})};n.deleteRecord=function(){n.deleteModalOpen=!1;var i=u.getSelectedRow(t.tables[n.dtOptions.id]);i&&(u.InfoNotify(),r.DelTxnAdj({AcctNo:n.acctNo,CardNo:i[1],TxnId:i[7]}).success(function(i){u.finalResultNotify(i.resultCd);t.tables[n.dtOptions.id].fnDraw()}))}}).controller("locationAcceptanceController",function(n,t,i,r,u){n.acctNo=i.acctNo?i.acctNo:t.obj.acctNo;n.modalOpen=!1;n.deleteModalOpen=!1;n.dtOptions={serverSide:!0,processing:!0,scrollX:!0,checkBox:!0,ordering:!1,id:"tblLocationAcceptance",ajax:t.getRootUrl()+"/Account/ftLocationList?AcctNo="+n.acctNo,edit:{level:"scope",func:"indexSelected"}};n.modalClick=function(){n.modalOpen=!0;u.makeObjectNull(n._Object,{AcctNo:n.acctNo})};n.RemoveSelectedState=function(t){var i=_.filter(n._Object.SelectedBusnLocations,function(n){return n.indexOf(t.Value)!=-1}),r;n._Object.SelectedBusnLocations=_.difference(n._Object.SelectedBusnLocations,i);_.each(n._Object.SelectedBusnLocations,function(i){i&&i.indexOf(t.Value)!=-1&&n._Object.SelectedBusnLocations.splice(n._Object.SelectedBusnLocations.indexOf(i),1)});r=n._Object.SelectedBusnLocations};n.StateSelected=function(t,i){var u=i.split(/,/g),f=u[u.length-1];r.getBusnLocations({States:f,AcctNo:n.acctNo}).success(function(t){var i=n._Object.SelectedBusnLocations,r;n._Object.SelectedBusnLocations=null;r=_.map(t,function(n){return n.Value});i?_.each(r,function(n){i.push(n)}):(i=[],i=r);console.log(i);n._Object.SelectedBusnLocations=i;n._Selects.BusnLocations=t})};r.getFormData({Prefix:"loc",AcctNo:n.acctNo}).success(function(t){t.Model.SelectedStates=[];n._Object=t.Model;n._Object.Func=!0;n._Selects=t.Selects});n.refresh=function(){t.tables[n.dtOptions.id].fnDraw()};n.Save=function(){u.InfoNotify();n._Object.AccNo=n.acctNo;r.SaveLocationAccept(n._Object).success(function(i){u.finalResultNotify(i.resultCd);i.resultCd.flag!=1&&(t.tables[n.dtOptions.id].fnDraw(),n.modalOpen=!1)})};n.deleteRecord=function(){n.deleteModalOpen=!1;var f=u.getSelectedRows(t.tables[n.dtOptions.id]),i=_.map(f,function(n){return n[1]});console.log(i);i&&(u.InfoNotify(),r.DelLocation({AcctNo:n.acctNo,BusnLoc:i}).success(function(i){u.finalResultNotify(i.resultCd);t.tables[n.dtOptions.id].fnDraw()}))}}).controller("caoController",function(n,t,i,r,u){var f=t.acctNo?t.acctNo:i.obj.acctNo;r.getFormData({Prefix:"cao",AcctNo:f}).success(function(t){n._Object=t.Model;console.log(t.Model);n._Selects=t.Selects});n.SaveCreditAssessmentOperation=function(){n._Object.acctNo=f;u.InfoNotify();r.SaveCreditAssessmentOperation(n._Object).success(function(t){u.finalResultNotify(t.result);i.tables[n.dtOptions.id].fnDraw();i.tables[n.dtRemarksHistoryOptions.id].fnDraw();n._Object.remarks=""})};n.dtRemarksHistoryOptions={serverSide:!0,processing:!0,dom:"lrtip",scrollX:!1,scrollCollapse:!1,id:"tblRemarksHistory",ajax:i.getRootUrl()+"/Account/WebRemarksHistoryListSelect?acctNo="+f+"&&eventType=cao",aoColumnDefs:[{aTargets:[0],mData:[0],mRender:function(n,t,i){var r='<div style="float:left;background:#d1d4d7;width:100%;"> <textarea class="form-control ng-pristine ng-valid" style ="width:100%;" rows="3"  maxlength="1000" readonly>'+n+"<\/textarea><\/div> ";return r+('<label style="float:right;font-weight:normal;margin-bottom:-10px;"> Created by '+i[1]+" on "+i[2]+" <\/label> <\/div>")}}],edit:{level:"scope"}};n.dtOptions={serverSide:!0,processing:!0,scrollX:!0,id:"tblCreditHistory",ajax:i.getRootUrl()+"/Account/WebAcctHistoryListSelect?acctNo="+f+"&&type=credit",edit:{level:"scope"}}}).controller("depositInfoController",function(n,t,i,r,u){var f=i.acctNo?i.acctNo:t.obj.acctNo;n.modalOpen=!1;r.getFormData({Prefix:"dep",AcctNo:f}).success(function(t){n._Object=t.Model;n._Object.acctNo=f;n._Selects=t.Selects});n.dtOptions={serverSide:!0,processing:!0,scrollX:!0,id:"tblDepositInfo",ajax:t.getRootUrl()+"/Account/ftGetAcctDepositInfoList?AcctNo="+f,edit:{level:"scope",func:"indexSelected"},aoColumnDefs:[{bVisible:!1,aTargets:[6]},]};n.dtSecurityDepositOptions={serverSide:!0,processing:!0,checkBox:!1,scrollX:!0,id:"tblSecurityDeposit",ajax:t.getRootUrl()+"/Account/WebAcctHistoryListSelect?AcctNo="+f+"&&type=sec",edit:{level:"scope",func:"securitySelected"}};n.refresh=function(){t.tables[n.dtOptions.id].fnDraw()};n.modalClick=function(){n.modalOpen=!0;u.makeObjectNull(n._Object,{acctNo:f})};n.$on("indexSelected",function(t,i){n.modalOpen=!0;r.ftGetGetAcctDepositInfoDetail({AccNo:f,TxnId:i[6]}).success(function(t){n._Object=t.Adi;n._Object.acctNo=f})});n.SaveAcctDepositInfoOps=function(){u.InfoNotify();r.AcctDepositInfoMaint(n._Object).success(function(i){u.finalResultNotify(i.result);i.result.flag!=1&&(t.tables[n.dtOptions.id].fnDraw(),n.modalOpen=!1);t.tables[n.dtSecurityDepositOptions.id].fnDraw()})}}).controller("vehiclesController",function(n,t,i,r,u){var f=i.acctNo?i.acctNo:t.obj.acctNo;n.modalOpen=!1;r.getFormData({Prefix:"veh",AcctNo:f}).success(function(t){n._Object=t.Model;n._Object.AccNo=f;n._Selects=t.Selects});n.dtOptions={serverSide:!0,processing:!0,scrollX:!1,id:"tblVehicles",ajax:t.getRootUrl()+"/Applications/ftVehicleList?AcctNo="+f,edit:{level:"scope",func:"indexSelected"}};n.refresh=function(){t.tables[n.dtOptions.id].fnDraw()};n.$on("indexSelected",function(t,i){n.modalOpen=!0;r.ftVehicleDetail({AcctNo:f,CardNo:i[0],VehRegtNo:i[3]}).success(function(t){n._Object=t.vehicle})});n.Save=function(){u.InfoNotify();r.SaveVehicleLimit(n._Object).success(function(i){u.finalResultNotify(i.resultCd);i.resultCd.flag!=1&&(t.tables[n.dtOptions.id].fnDraw(),n.modalOpen=!1)})}}).controller("skdsController",function(n,t,i,r,u){var f=i.acctNo?i.acctNo:t.obj.acctNo;n.modalOpen=!1;n.dtOptions={serverSide:!0,processing:!0,scrollX:!0,ajax:t.getRootUrl()+"/Applications/ftSKDSList?AccNo="+f,id:"tblSkds",edit:{level:"scope",func:"indexSelected"}};r.getFormData({Prefix:"skd",AcctNo:f},t.getRootUrl()+"/Applications").success(function(t){n._Object=t.Model;n._Object.AcctNo=f;n._Selects=t.Selects});n.refresh=function(){t.tables[n.dtOptions.id].fnDraw()};n.$on("indexSelected",function(t,i){n.modalOpen=!0;var u=i;r.ftSKDSDetail({AccNo:f,TxnId:i[8]}).success(function(t){n._Object=t.subs;n._Object.AccNo=f})});n.SaveSKDS=function(){u.InfoNotify();r.SaveSKDS(n._Object).success(function(i){u.finalResultNotify(i.result);i.result.flag!=1&&(t.tables[n.dtOptions.id].fnDraw(),n.modalOpen=!1)})};n.modalClick=function(){u.makeObjectNull(n._Object,{AccNo:f});n.modalOpen=!0}}).controller("accountSubsidyController",function(n,t,i,r,u){var f=i.acctNo||t.obj.acctNo;n.dtOptions={serverSide:!1,processing:!0,scrollX:!0,retrieve:!0,autoWidth:!1,id:"tblacctSubsidy"};n.refresh=function(){t.tables[n.dtOptions.id].fnDraw()};r.getFormData({Prefix:"ast",AcctNo:f},t.getRootUrl()+"/Account").success(function(t){n._Object=t.Model;n._Object.AccNo=f;n._Selects=t.Selects});n.SaveAcctSubsidyInfoList=function(){var t=[];u.InfoNotify();$("#tblAcctSubsidy").find("tbody tr").each(function(n,i){var r=$(i),u=r.find("td:eq(5)").find("select").val();u&&t.push({VehRegsNo:r.find("td:first").text(),CardNo:r.find("td:eq(1)").text(),SelectedSts:u=="2"?"A":u=="3"?"C":"",SKDSNo:r.find("td:eq(3)").find("select").val(),SKDSQuota:r.find("td:eq(4)").find("input").val()})});console.log(t);t.length>0&&r.SaveAcctSubsidyInfoList({skds:t,AcctNo:f,SKDSNo:n._Object.SelectedSkdsAcctSub}).success(function(t){u.finalResultNotify(t.result);n.SubsidyChanged(null,n._Object.SelectedSkdsAcctSub)})};n.SubsidyChanged=function(i,r){var o=$("select"),i={AcctNo:f,SkdsNo:i?i.Value:r},s=t.tables[n.dtOptions.id],u=t.getRootUrl()+"/Account/ftAcctSubsidyInfoList?"+$.param(i),e=angular.extend(n.dtOptions,{serverSide:!0,ajax:u,destroy:!0,createdRow:function(t,i){var u=$("#acctSubsidySts").clone(),e,r,f;u.find("option").removeAttr("selected");e=i[5]=="A"?"2":i[5]=="C"?"3":"";u.find('option[value="'+e+'"]').attr("selected","selected");r=$('<select class="form-control" style="width:100%" name="status" />');$("<option />",{value:"",text:""}).appendTo(r);r.find("option").removeAttr("selected");n._Selects.SkdsAcctSub.forEach(function(n){$("<option />",{value:n.Value,text:n.Text}).appendTo(r)});r.find('option[value="'+n._Object.SelectedSkdsAcctSub+'"]').attr("selected","selected");f=$('<input type="text" class="form-control" value="">');f.priceFormat({prefix:"",centsSeparator:".",thousandsSeparator:","}).val(i[4]);$("td",t).eq(3).html(r);$("td",t).eq(4).html(f);$("td",t).eq(5).html(u)},columnDefs:[{type:"html",targets:3},{type:"html",targets:4},{type:"html",targets:5}]});n.$broadcast("updateDataTable",{options:e})}}).controller("contactsController",function(n,t,i,r,u){var f=i.acctNo?i.acctNo:t.obj.acctNo;n.modalOpen=!1;n.deleteModalOpen=!1;n.isUpdate=!1;r.getFormData({Prefix:"con",AcctNo:f}).success(function(t){n._Object=t.Model;n._Selects=t.Selects;n._Object.RefTo="ACCT";n._Object.RefKey=f});n.dtOptions={serverSide:!0,processing:!0,scrollX:!1,id:"tblContacts",ajax:t.getRootUrl()+"/Applications/ftContactList?RefTo=acct&RefKey="+f,edit:{level:"scope",func:"indexSelected"},rowClick:function(){}};n.refresh=function(){t.tables[n.dtOptions.id].fnDraw()};n.modalClick=function(){n.modalOpen=!0;u.makeObjectNull(n._Object,{RefKey:f,RefTo:"acct",Func:"Add"});n.isUpdate=!1};n.SaveContact=function(){u.InfoNotify();r.SaveContact(n._Object).success(function(i){u.finalResultNotify(i.resultCd);i.resultCd.flag!=1&&(t.tables[n.dtOptions.id].fnDraw(),n.modalOpen=!1)})};n.ResendActivationEmail=function(){var i=u.getSelectedRow(t.tables[n.dtOptions.id]);i&&(u.InfoNotify(),r.ResendActivationEmail({AcctNo:f,UserId:i[5]}).success(function(n){u.finalResultNotify(n.resultCd)}))};n.$on("indexSelected",function(t,i){n.modalOpen=!0;n.isUpdate=!0;r.ftContactDetail({RefCd:i[0],RefKey:f,RefTo:"acct"}).success(function(t){n._Object=t.contact;n._Object.RefKey=f;n._Object.RefTo="acct";n._Object.RefCd=i[0];n._Object.Func="Upd"})});n.deleteRecord=function(){n.deleteModalOpen=!1;var i=u.getSelectedRow(t.tables[n.dtOptions.id]);i&&(u.InfoNotify(),r.RemoveContact({RefCd:i[0],RefKey:f,RefTo:"acct"}).success(function(i){u.finalResultNotify(i.resultCd);t.tables[n.dtOptions.id].fnDraw()}))}}).controller("cardsListController",function(n,t,i){var r=i.acctNo?i.acctNo:t.obj.acctNo;n.dtOptions={serverSide:!0,processing:!0,scrollX:!0,ajax:t.getRootUrl()+"/Account/ftCardHolderList?AcctNo="+r,id:"tblCards",edit:{level:"scope",func:"indexSelected"}};n.$on("indexSelected",function(n,i){location.href=t.getRootUrl()+"/Card#/"+r+"/"+i[0]});n.refresh=function(){t.tables[n.dtOptions.id].fnDraw()}}).controller("addressController",function(n,t,i,r,u){n.modalOpen=!1;var f=i.acctNo?i.acctNo:t.obj.acctNo;r.getFormData({Prefix:"add",AcctNo:f}).success(function(t){n._Object=t.Model;n._Object.RefTo="ACCT";n._Object.RefKey=f;n._Selects=t.Selects});n.dtOptions={serverSide:!0,processing:!0,scrollX:!1,autoWidth:!1,id:"tblAddress",edit:{level:"scope",func:"indexSelected"},aoColumnDefs:[{sWidth:"200px",aTargets:[3,4,5,6,7]},],ajax:t.getRootUrl()+"/Applications/ftAddressList?RefKey="+f+"&RefTo=acct"};n.refresh=function(){t.tables[n.dtOptions.id].fnDraw()};n.modalClick=function(){n.modalOpen=!0;u.makeObjectNull(n._Object,{RefKey:f,RefTo:"acct",Func:"Add"})};n.Save=function(){u.InfoNotify();r.SaveAddress(n._Object).success(function(i){u.finalResultNotify(i.resultCd);i.resultCd.flag==0&&(t.tables[n.dtOptions.id].fnDraw(),n.modalOpen=!1)})};n.$on("indexSelected",function(t,i){n.modalOpen=!0;r.ftAddressDetail({RefCd:i[0],RefKey:f,RefTo:"acct"}).success(function(t){n._Object=t.address;angular.extend(n._Object,{RefKey:f,RefTo:"acct",RefCd:i[0],Func:"Upd"});n.updateState(t.address.SelectedCountry)})});n.Remove=function(){n.deleteModalOpen=!1;var i=u.getSelectedRow(t.tables[n.dtOptions.id]);i&&(u.InfoNotify(),r.DelAddress({RefCd:i[0],RefKey:f,RefTo:"acct"}).success(function(i){u.finalResultNotify(i.result);t.tables[n.dtOptions.id].fnDraw()}))};n.CountryChanged=function(t,i){n.updateState(i)};n.updateState=function(t){r.WebGetState({CountryCd:t}).success(function(t){n._Selects.State=t})}}).controller("txnSearchController",function(n,t,i,r,u,f){n.modalOpen=!1;n.aaData=[];var e=i.acctNo?i.acctNo:t.obj.acctNo;u.getFormData({Prefix:"aps",AcctNo:e}).success(function(t){n._Object=t.Model;n._Object.AcctNo=e;n._Selects=t.Selects});n.dtOptions={serverSide:!1,processing:!0,scrollX:!0,autoWidth:!1,retrieve:!0,id:"tblTxnSearch",aoColumnDefs:[{sClass:"detail-toggler",aTargets:[0]},],childTable:{format:function(t){var r=_.filter(n.aaData,function(n){return n[13]==t[13]}),u=_.map(r,function(n){return"<tr><td style='background-color:#F8F9FA'>"+n[15]+"<\/td><td style='background-color:#F8F9FA'>"+n[16]+"<\/td><td style='background-color:#F8F9FA'>"+n[17]+"<\/td><td style='background-color:#F8F9FA'>"+n[18]+"<\/td><td style='background-color:#F8F9FA'>"+n[19]+"<\/td><td style='background-color:#F8F9FA'>"+n[20]+"<\/td><\/tr>"}),i='<table class="table childtable"><thead><tr><th>Product Descp<\/th><th>Quantity<\/th><th>Product Amount<\/th><th>VAT Amount<\/th><th>VAT Cd<\/th><th>VAT Rate<\/th><\/tr><\/thead><tbody>'+u.join("")+"<\/tbody><\/table>";return console.log(i),"<tr class='dynamic-created'><td style='border-top:0' colspan='16'>"+i+"<\/td><\/tr>"},sum:function(n){return _.reduce(n,function(n,t){return n+parseFloat(t[9])},0)},fngroupOp:function(t,i,r){if(!n.date||!(new Date-n.date<=2e3)){n.$apply(function(){n.date=new Date;n.aaData=r.aaData});var u=[];_.each(r.aaData,function(n){if(u.length){var t=_.find(u,function(t){return t[13]==n[13]});t||u.push(n)}else u.push(n)});r.aaData=u}}}};n.refresh=function(){t.tables[n.dtOptions.id].fnDraw()};n.modalClick=function(){n.modalOpen=!0;f.makeObjectNull(n._Object,{RefKey:e,RefTo:"acct"})};n.SearchTxn=function(){obj=n._Object;var f=t.tables[n.dtOptions.id],i=t.getRootUrl()+"/Account/ftAcctPostedTxnSearch?",r=$.param({SelectedCardNo:obj.SelectedCardNo,SelectedTxnCategory:obj.SelectedTxnCategory,SelectedTxnCd:obj.SelectedTxnCd,FromDate:obj.FromDate,ToDate:obj.ToDate,AcctNo:e}),u=angular.extend(n.dtOptions,{serverSide:!0,ajax:i+r,destroy:!0,drawCallback:function(){n.modalOpen=!1;n.$apply()}});n.$broadcast("updateDataTable",{options:u})}}).controller("MiscellaniousController",function(n,t,i,r,u){var f=i.applId?i.applId:t.applId;r.getFormData({Prefix:"mis"}).success(function(t){n._Object=t.Model;n._Selects=t.Selects;n._Object.ApplId=f});n.Save=function(){u.InfoNotify();r.SaveMiscellanious(n._Object).success(function(n){u.finalResultNotify(n.resultCd)})}}).controller("costcentreController",function(n,t,i,r,u,f){n.modalOpen=!1;var e=i.acctNo?i.acctNo:t.acctNo;n.isUpdate=!1;u.getFormData({Prefix:"csc",AcctNo:e}).success(function(t){n._Object=t.Model;n._Object.RefTo="ACCT";n._Object.RefKey=e;n._Selects=t.Selects});n.dtOptions={serverSide:!0,processing:!0,scrollX:!1,id:"tblCostCentre",edit:{level:"scope",func:"indexSelected"},ajax:t.getRootUrl()+"/Account/ftCostCentreList?RefKey="+e+"&RefTo=acct"};n.gotoVelocity=function(){var i=f.getSelectedRow(t.tables[n.dtOptions.id]);r.path("/costcentre/"+e+"/"+i[0]+"/velocity")};n.refresh=function(){t.tables[n.dtOptions.id].fnDraw()};n.modalClick=function(){n.modalOpen=!0;n.isUpdate=!1;f.makeObjectNull(n._Object,{RefKey:e,RefTo:"acct"})};n.Save=function(){f.InfoNotify();u.CostCentreMaint(n._Object).success(function(i){f.finalResultNotify(i.resultCd);i.resultCd.flag!=1&&(t.tables[n.dtOptions.id].fnDraw(),n.modalOpen=!1)})};n.$on("indexSelected",function(t,i){n.modalOpen=!0;n.isUpdate=!0;var i={SelectedCostCentre:i[0],RefKey:e,RefTo:"acct"};u.FtCostCentreDetail(i).success(function(t){angular.extend(n._Object,t,i)})})}).controller("billingItemController",function(n,t,i,r,u,f){n.modalOpen=!1;var e=i.acctNo?i.acctNo:t.acctNo;u.getFormData({Prefix:"bil",AcctNo:e}).success(function(t){n._Object=t.Model;n._Object.AccNo=e;n._Selects=t.Selects});n.dtOptions={serverSide:!1,processing:!0,scrollX:!1,retrieve:!0,autoWidth:!1,id:"tblbillingSearch",edit:{level:"scope",func:"indexSelected"},rowCallback:function(t,i){n.modalOpen=!1;n.tarBalance=t[9];n.totalBillingTxnAmt=t[11];n.TotalSettledAmt=t[12];n.$apply();t[0]=="T"&&$(i).css("background-color","#D5D5D5")}};n.$on("indexSelected",function(n){var t=r.path(n[0]);r.path("#/generalInfo/"+t)});n.navSettlementDtl=function(){var i=f.getSelectedRow(t.tables[n.dtOptions.id]);t.selectedBilling=i;i&&r.path("/billingItemDetail/"+e+"/settlement/"+i[9])};n.navTxnList=function(){var i=f.getSelectedRow(t.tables[n.dtOptions.id]);t.selectedBilling=i;i&&r.path("/billingItemDetail/"+e+"/txnlist/"+i[9])};n.modalClick=function(){n.modalOpen=!0};n.refresh=function(){t.tables[n.dtOptions.id].fnDraw()};n.SearchBillingItem=function(){obj=n._Object;var f=t.tables[n.dtOptions.id],i=t.getRootUrl()+"/Account/ftSearchBillingItem?",r=$.param({FromDate:obj.FromDate,ToDate:obj.ToDate,SelectedTxnCategory:obj.SelectedTxnCategory,SelectedSts:obj.SelectedSts,AccNo:e}),u=angular.extend(n.dtOptions,{serverSide:!0,ajax:i+r,destroy:!0});n.$broadcast("updateDataTable",{options:u})}}).controller("billingDetailController",function(n,t,i){var u,r;n.modalOpen=!1;u=i.acctNo?i.acctNo:t.acctNo;n.txnId=i.txnId;n.txnType=i.type;r=t.selectedBilling;n.Details={Descp:r[1],TxnDate:r[2],DueDate:r[3],BillingAmt:r[4]};n.txnType=="settlement"?n.dtOptions={serverSide:!0,processing:!0,scrollX:!1,id:"tblBillingItemSettlement",ajax:t.getRootUrl()+"/Account/ftBillingItemSettlementList?Txn="+n.txnId}:n.txnType=="txnlist"&&(n.dtOptions={serverSide:!0,processing:!0,scrollX:!1,id:"tblBillingItemTxnList",ajax:t.getRootUrl()+"/Account/ftBillingItemTxnList?Txn="+n.txnId})}).controller("userManagementController",function(n,t,i,r,u,f){var e=i.acctNo?i.acctNo:t.acctNo;n.dtOptions={serverSide:!0,processing:!0,scrollX:!1,id:"tblusers",edit:{level:"scope",func:"indexSelected"},ajax:t.getRootUrl()+"/Account/AccountUsersListSelect?AcctNo="+e};n.refresh=function(){t.tables[n.dtOptions.id].fnDraw()};n.ResendActivationEmail=function(){var i=f.getSelectedRow(t.tables[n.dtOptions.id]);i&&(f.InfoNotify(),u.ResendActivationEmail({AcctNo:e,UserId:i[0]}).success(function(n){f.finalResultNotify(n.resultCd)}))};n.ResetPasswordCounter=function(){var i=f.getSelectedRow(t.tables[n.dtOptions.id]);i&&(f.InfoNotify(),u.ResetPasswordCounter({AcctNo:e,UserId:i[0]}).success(function(n){f.finalResultNotify(n.resultCd)}))}}).controller("productDiscountController",function(n,t,i,r,u){n.modalOpen=!1;n.searchModalOpen=!1;n.deleteModalOpen=!1;var f=i.acctNo?i.acctNo:t.obj.acctNo;r.getFormData({Prefix:"pdc",AcctNo:f}).success(function(t){n._Object=t.Model;n._Object.RefTo="ACCT";n._Object.RefKey=f;n._Selects=t.Selects});n.dtOptions={serverSide:!0,processing:!0,scrollX:!1,id:"tblProductDiscount",edit:{level:"scope",func:"indexSelected"},ajax:t.getRootUrl()+"/Account/WebProductDiscountListSelect?RefTo=ACCT&AcctNo="+f,rowCallback:function(){n.searchModalOpen=!1}};n.SubsidyChanged=function(t,i){console.log(i);i?r.GetPlanIdFromSubsidy({SelectedProdDiscType:i}).success(function(t){console.log(t);n._Selects.PlanId=t.PlanId}):n._Selects.PlanId=[]};n.searchProductDiscount=function(){obj=n._Object;var e=t.tables[n.dtOptions.id],i=t.getRootUrl()+"/Account/WebProductDiscountListSelect?",r=$.param({DiscType:obj.SelectedProdDiscType,AcctNo:f,Refto:"ACCT"}),u=angular.extend(n.dtOptions,{serverSide:!0,ajax:i+r,destroy:!0});n.$broadcast("updateDataTable",{options:u})};n.refresh=function(){t.tables[n.dtOptions.id].fnDraw()};n.modalClick=function(){n.modalOpen=!0;u.makeObjectNull(n._Object,{Func:"N",AcctNo:f,RefTo:"ACCT"})};n.Save=function(){u.InfoNotify();r.ProductDiscountMaint(n._Object).success(function(i){u.finalResultNotify(i.result);i.result.flag==0&&(t.tables[n.dtOptions.id].fnDraw(),n.modalOpen=!1)})};n.$on("indexSelected",function(t,i){n.modalOpen=!0;r.ProductDiscountSelect({DiscType:i[2],AcctNo:f,Id:i[10],RefTo:"ACCT"}).success(function(t){n._Object=t.Discount;n._Object.Func="E";n._Object.AcctNo=f;n._Object.RefTo="ACCT";n.SubsidyChanged(null,n._Object.SelectedProdDiscType);n.$apply()})});n.Remove=function(){n.deleteModalOpen=!1;var i=u.getSelectedRow(t.tables[n.dtOptions.id]);i&&(u.InfoNotify(),r.DeleteProductDiscount({SelectedProdCd:i[0],SelectedProdDiscType:i[2],EffDateFrom:i[5],RefKey:f,AcctNo:f,RefTo:"ACCT"}).success(function(i){u.finalResultNotify(i.result);t.tables[n.dtOptions.id].fnDraw()}))}}).controller("pointsAdjustmentController",function(n,t,i,r,u){n.modalOpen=!1;n.searchModalOpen=!1;n.deleteModalOpen=!1;var f=i.acctNo?i.acctNo:t.obj.acctNo;r.getFormData({Prefix:"pad",AcctNo:f}).success(function(t){n._Object=t.Model;n._Object.RefTo="ACCT";n._Object.RefKey=f;n._Selects=t.Selects});n.dtOptions={serverSide:!0,processing:!0,scrollX:!1,id:"tblPointsAdjustment",edit:{level:"scope",func:"indexSelected"},ajax:t.getRootUrl()+"/Account/WebPointAdjustmentListSelect?AcctNo="+f};n.refresh=function(){t.tables[n.dtOptions.id].fnDraw()};n.modalClick=function(){n.modalOpen=!0;u.makeObjectNull(n._Object,{Func:"N",AcctNo:f})};n.Save=function(){u.InfoNotify();r.WebPointAdjustmentMaint(n._Object).success(function(i){u.finalResultNotify(i.result);i.result.flag==0&&(t.tables[n.dtOptions.id].fnDraw(),n.modalOpen=!1)})};n.$on("indexSelected",function(t,i){n.modalOpen=!0;r.WebPointAdjustmentSelect({AcctNo:f,TxnId:i[7]}).success(function(t){n._Object=t.Adj;n._Object.Func="E";n._Object.AcctNo=f})})}).controller("pukalController",function(n,t,i,r,u){n._Object=null;var f=t.acctNo?t.acctNo:i.obj.acctNo;r.getFormData({Prefix:"puk",AcctNo:f}).success(function(t){n._Object=t.Model;n._Selects=t.Selects;n._Object.RefKey=f});n.Save=function(){u.InfoNotify();r.PukalMaint(n._Object).success(function(n){u.finalResultNotify(n.resultCd)})}}).controller("eventConfigurationAcct",function(n,t,i,r,u,f){n._Object=null;var e=t.acctNo?t.acctNo:r.obj.acctNo;u.getFormData({Prefix:"puk",AcctNo:e}).success(function(t){n._Object=t.Model;n._Selects=t.Selects;n._Object.RefKey=e});n.Save=function(){f.InfoNotify();u.PukalMaint(n._Object).success(function(n){f.finalResultNotify(n.resultCd)})}}).controller("eventConfigurationController",function(n,t,i,r,u,f,e){var c;n.Items=[];var o=null,l=[],s={},h={};n.Recipients=[];n.detailModalOpen=!1;n.getClass=function(t){var i=n.Items.indexOf(t),t=t};c=[{Value:"c",Text:"Current Cycle"},{Value:"s",Text:"Set checking period"}];n.mapper=f.getEventMap();n.acctNo=t.acctNo?t.acctNo:r.obj.acctNo;n.isListView=t.id?!1:!0;n.isListView?(n._Object=null,n.dtOptions={serverSide:!0,processing:!0,scrollX:!1,id:"tblEventConf",edit:{level:"scope",func:"indexSelected"},ajax:r.getRootUrl()+"/Account/WebEventAcctConfListSelect?RefTo=ACCT&RefKey="+n.acctNo}):(n.EventId=t.id,n.scheduleId=t.scheduleId,u.WebEventAcctConfSelect({EventTypeId:n.EventId,EventScheduleId:n.scheduleId,AcctNo:n.acctNo}).success(function(t){n.callBack(t)}));n.$on("indexSelected",function(t,r){i.path("/eventConfDetail/"+n.acctNo+"/"+r[0]+"/"+r[1]);n.$apply()});n.callBack=function(t){n.Items=[];n._Object=t.Model[0];n._Selects=t.Selects;n._Selects.PeriodType=c;n._Object.SelectedScope&&(n._Object.SelectedOwner=n._Object.SelectedScope);n._Object.SelectedOccur=n._Object.MaxOccur>0?"S":"E";n.bitmapControls=[];_.each(t.Model,function(t,i){var r={MinIntVal:t.MinIntVal,MaxIntVal:t.MaxIntVal,MinMoneyVal:t.MinMoneyVal,MaxMoneyVal:t.MaxMoneyVal,MinDateVal:t.MinDateVal,MaxDateVal:t.MaxDateVal,MinTimeVal:t.MinTimeVal,MaxTimeVal:t.MaxTimeVal,VarCharVal:t.VarCharVal,PeriodType:t.PeriodType,PeriodInterval:t.PeriodInterval,BitmapAmt:t.BitmapAmt,id:i,EvtPlanDetailId:t.EvtPlanDetailId},e,u;r.SelectedOccur=r.PeriodInterval>0?"S":"C";r.BitmapAmt>0&&(e=f.findBinarySequence(r.BitmapAmt).sort(),u=[],_.each(e,function(t){var i=_.find(n.mapper,function(n){return n.id==t});i&&(i.val=r[i.type],u.push(i))}),n.bitmapControls.push(u),l=n.bitmapControls[0]);n.Items.push(r);o=r});n.WebEventAcctRcptListSelect({ScheduleId:n.scheduleId})};n.selectedOccurChanged=function(t){t=="E"?(n._Object.MaxOccur="-1",n._Object.SelectedFrequency=""):n._Object.MaxOccur=""};n.intervalChanged=function(t){t=="C"&&(n.Items[n.selectedItem].PeriodInterval=0,n.Items[n.selectedItem].PeriodType="C")};n.WebEventAcctRcptListSelect=function(t){u.WebEventAcctRcptListSelect(t).success(function(t){_.each(t,function(t){var i={ChannelInd:t.ChannelInd,ContactName:t.ContactName,ContactNo:t.ContactNo,Id:t.Id,LangInd:t.LangInd};i.NotifyIndEmail=!1;i.NotifyIndSms=!1;(t.ChannelInd==1||n._Object.ChannelInd==3)&&(i.NotifyIndEmail=!0);(t.ChannelInd==2||t.ChannelInd==3)&&(i.NotifyIndSms=!0);n.Recipients.push(i)})})};n.containsBitmap=function(t,i){var r=n.bitmapControls[t],u=_.find(r,function(n){return n.id==i});return u?!0:!1};n.editItem=function(t){n.isItemEdit=!0;var i=n.Items.indexOf(t);n.selectedItem=i;s=$.extend({},n.Items[i]);h=$.extend({},n.bitmapControls[i]);n.detailModalOpen=!0};n.CreateNewItem=function(t){t.currentTarget.blur();n.isItemEdit=!1;var i=jQuery.extend({},o);f.makeObjectNull(i,{BitmapAmt:n.Items[n.Items.length-1].BitmapAmt,id:n.Items.length});n.Items.push(i);n.bitmapControls.push(n.bitmapControls[n.bitmapControls.length-1]);n.selectedItem=n.Items.length-1;n.detailModalOpen=!0};n.removeItem=function(t){var i=n.Items.indexOf(t);n.itemtDeleteIndex=i;n.itemDeleteModalOpen=!0};n.confirmitemDelete=function(){n.Items.splice(n.itemtDeleteIndex,1);n.bitmapControls.splice(n.itemtDeleteIndex,1);n.itemDeleteModalOpen=!1};n.finishEdit=function(){n.detailModalOpen=!1};n.cancelEdit=function(){n.isItemEdit?(n.Items[n.selectedItem]=s,n.bitmapControls[n.selectedItem]=h):(n.Items.splice(n.selectedItem,1),n.bitmapControls.splice(n.selectedItem,1));n.detailModalOpen=!1};n.toggleStatus=function(t){n._Object.SelectedStatus=t};n.updateCompanyName=function(){u.WebGetRefCmpyName({SelectedRefTo:n._Object.SelectedRefTo,RefKey:n._Object.RefKey}).success(function(t){t&&(n._Object.CompanyName=t.companyName)})};n.CreateNewRecipient=function(t){t.currentTarget.blur();n.Recipients.push({NotifyInd:null,ContactName:"",ContactNo:"",NotifyIndEmail:!1,NotifyIndSms:!1,LangInd:"",isEdit:!0,isNew:!0});n.selectedContact=n.Recipients.length-1;n.contactModalOpen=!0};n.editRecipient=function(t){t.ContactNoDuplicate=t.ContactNo;t.ContactNameDuplicate=t.ContactName;t.NotifyIndEmailDuplicate=t.NotifyIndEmail;t.NotifyIndSmsDuplicate=t.NotifyIndSms;n.selectedContact=n.Recipients.indexOf(t);n.contactModalOpen=!0};n.removeRecipient=function(t){var i=n.Recipients.indexOf(t);n.recipientDeleteIndex=i;n.contactDeleteModalOpen=!0};n.confirmremoveRecipient=function(){n.confirmremoveRecipient=function(){n.Recipients[n.recipientDeleteIndex].isNew?(n.Recipients.splice(n.recipientDeleteIndex,1),n.contactDeleteModalOpen=!1):(f.InfoNotify(),u.WebNtfEvtConfRcptDelete({SchRcptId:n.Recipients[n.recipientDeleteIndex].Id}).success(function(t){f.finalResultNotify(t);n.Recipients.splice(n.recipientDeleteIndex,1);n.contactDeleteModalOpen=!1}))}};n.switchMedium=function(t,i){var r=n.Recipients[t];r.NotifyIndSms=!1;r.NotifyIndEmail=!1;i=="sms"?r.NotifyIndSms=!0:i=="email"&&(r.NotifyIndEmail=!0)};n.cancelContact=function(t){if(t.isNew){var i=n.Recipients.indexOf(t);n.Recipients.splice(i,1)}else t.ContactNo=t.ContactNoDuplicate,t.ContactName=t.ContactNameDuplicate,t.NotifyIndEmail=t.NotifyIndEmailDuplicate,t.NotifyIndSms=t.NotifyIndSmsDuplicate;n.contactModalOpen=!1};n.finishEditContact=function(t){if(!t.ContactNo||!t.ContactName||!t.LangInd)return f.PNotify({flag:1,Descp:"Please fill in all fields"});t.isEdit=!1;n.Recipients.indexOf(t).ContactNoDuplicate=null;n.contactModalOpen=!1};n.finishEdit=function(){n.detailModalOpen=!1};n.saveAll=function(){var t=n._Object,r;if(t._EventRcptList=n.Recipients,t.ProductItems=n.Items,r=0,!n.Recipients.length)return f.PNotify({flag:1,Descp:"Atleast one recipient details must be filled."});_.each(t._EventRcptList,function(n){n.NotifyIndSms?n.ChannelInd=2:n.NotifyIndEmail&&(n.ChannelInd=1)});f.InfoNotify();u.WebEventAcctConfMaint(t).success(function(t){t.flag==0&&(n._Object.EventScheduleId=="0"?i.path(i.$$url+t.Id):e.reload());f.finalResultNotify(t)})}}).directive("bootstrapWizard",function(){return{restrict:"A",link:function(n,t){t.bootstrapWizard({nextSelector:".button-next",previousSelector:".button-previous",onNext:function(){},onTabShow:function(n,i,r){var f=i.find("li").length,u=r+1,e=u/f*100;t.find(".progress-bar").css({width:e+"%"});t.find(".steps li").each(function(n){$(this).removeClass("complete");n+=1;n<u&&$(this).addClass("complete")});u>=f?($("#wizard2").find(".button-next").hide(),$("#wizard2").find(".button-finish").show()):($("#wizard2").find(".button-next").show(),$("#wizard2").find(".button-finish").hide())}})}}});
//# sourceMappingURL=account.min.js.map